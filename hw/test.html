<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RWD æº«åº¦è¨ˆ</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        /* è¨­å®šä¸»è¦æ¨£å¼ */
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            font-family: Arial, sans-serif;
            text-align: center;
        }

        h2 {
            font-size: clamp(1.2rem, 2.5vw, 2rem);
            /* è®“æ¨™é¡Œåœ¨ä¸åŒè£ç½®å¤§å°é©æ‡‰ */
        }

        .thermometer-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .thermometer {
            width: clamp(40px, 10vw, 60px);
            /* è®“æº«åº¦è¨ˆçš„å¯¬åº¦é©æ‡‰ä¸åŒè£ç½® */
            height: clamp(200px, 60vh, 400px);
            /* é«˜åº¦åœ¨æ‰‹æ©Ÿã€å¹³æ¿ã€é›»è…¦ä¸Šè‡ªé©æ‡‰ */
            background: #ddd;
            border-radius: 25px;
            position: relative;
            overflow: hidden;
            border: 2px solid #999;
            margin-top: 20px;
        }

        .temperature {
            width: 100%;
            position: absolute;
            bottom: 0;
            background: red;
            transition: height 0.5s;
        }

        .temp-text {
            margin-top: 10px;
            font-size: clamp(1rem, 2vw, 1.5rem);
            /* è®“æº«åº¦æ•¸å­—é©æ‡‰ä¸åŒè£ç½® */
            font-weight: bold;
        }
    </style>
</head>

<body>

    <h2>ç•¶å‰æº«åº¦</h2>
    <div class="thermometer-container">
        <div class="thermometer">
            <div class="temperature" id="tempBar" style="height: 0;"></div>
        </div>
        <div class="temp-text">æº«åº¦ï¼š<span id="tempValue">--</span>Â°C</div>
    </div>

    <script src="./pw/pw.js"></script>
    <script>
        function fetchTemperature() {
            let apiKey = "ä½ çš„API_KEY";  // ğŸ”¹ è«‹åˆ° OpenWeather è¨»å†Šå–å¾— API KEY
            let city = "Taipei";  // ğŸ”¹ ä½ çš„åŸå¸‚åç¨±
            // let apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${apiKey}`;
            let url1 = `https://opendata.cwa.gov.tw/api/v1/rest/datastore/F-D0047-069?Authorization=${pwd}`
            $.ajax({
                type: "get",
                url: url1,
                dataType: "Json",
                success: function (res) {
                    console.log(res);
                    let data = res.records.Locations[0].Location[15];

                    let WeatherElement = data.WeatherElement
                    let Temperature = WeatherElement[0].Time[0].ElementValue[0].Temperature
                    console.log(Temperature);
                    $("#tempValue").text(Temperature);  // é¡¯ç¤ºæ•¸å­—æº«åº¦
                    updateThermometer(Temperature); // æ›´æ–°æº«åº¦è¨ˆ

                }
            })

        }

        function updateThermometer(temp) {
            let minTemp = -10;  // æœ€ä½æº«åº¦ï¼ˆå¯èª¿æ•´ï¼‰
            let maxTemp = 40;   // æœ€é«˜æº«åº¦ï¼ˆå¯èª¿æ•´ï¼‰
            let height = ((temp - minTemp) / (maxTemp - minTemp)) * 100;

            if (height < 0) height = 0;
            if (height > 100) height = 100;

            $("#tempBar").css("height", height + "%");
        }

        // é é¢åŠ è¼‰æ™‚ç²å–æº«åº¦
        $(document).ready(function () {
            fetchTemperature();
            setInterval(fetchTemperature, 600000);  // æ¯ 1 åˆ†é˜æ›´æ–°ä¸€æ¬¡
        });
    </script>

</body>

</html>